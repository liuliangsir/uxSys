<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="format-detection" content="telephone=no, email=no"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <!-- 删除苹果默认的工具栏和菜单栏 -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <!-- 设置苹果工具栏颜色 -->
    <meta name="format-detection" content="telphone=no, email=no"/>
    <!-- 忽略页面中的数字识别为电话，忽略email识别 -->
    <!-- 启用360浏览器的极速模式(webkit) -->
    <meta name="renderer" content="webkit">
    <!-- 避免IE使用兼容模式 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- 针对手持设备优化，主要是针对一些老的不识别viewport的浏览器，比如黑莓 -->
    <meta name="HandheldFriendly" content="true">
    <!-- 微软的老式浏览器 -->
    <meta name="MobileOptimized" content="320">
    <!-- uc强制竖屏 -->
    <meta name="screen-orientation" content="portrait">
    <!-- QQ强制竖屏 -->
    <meta name="x5-orientation" content="portrait">
    <!-- UC强制全屏 -->
    <meta name="full-screen" content="yes">
    <!-- QQ强制全屏 -->
    <meta name="x5-fullscreen" content="true">
    <!-- UC应用模式 -->
    <meta name="browsermode" content="application">
    <!-- QQ应用模式 -->
    <meta name="x5-page-mode" content="app">
    <!-- windows phone 点击无高光 -->
    <meta name="msapplication-tap-highlight" content="no">
    <!-- 适应移动端end -->
    <title>用研展示-管理新增页</title>
    <link rel="stylesheet" href="http://image.yihaodianimg.com/mobile-ued/FFF/v0.1.2/style/base.css">
    <link rel="stylesheet" href="/css/ux.css">
</head>
<body>
<!--[if lt IE 11]>
<p class="browseHappy">您使用的浏览器版本<strong>过老</strong>，请<a href="http://browsehappy.com/">使用最新的浏览器</a>来提升浏览体验。</p>
<![endif]-->

<header class="ux_head">
</header>


<form id="projectForm"   class="W_uxContent">
    <ul>
        <li><span>项目名称：</span><input type="text" name="projectName" placeholder="请输入项目名字" required></li>
        <li><span>项目描述：</span><textarea name="description" placeholder="请输入项目描述" required></textarea></li>
        <li>
            <a id="J_selectFile">新增文件</a>
        </li>
    </ul>
    <button type="submit">确定</button>
    <a href="/admin">取消</a>
</form>


<script src="http://libs.useso.com/js/jquery/2.1.1-rc2/jquery.min.js"></script>
<script src="/js/resumable.js"></script>
<script>
    var r = new Resumable({
        target:'/file/upload',
        chunkSize:1*1024*1024,
        simultaneousUploads:8,
        query:{
            realType:'pdf',
            realName:'test'
        },
        throttleProgressCallbacks:1
    });

    r.assignBrowse($('#J_selectFile')[0]);

    r.on('fileAdded', function(file){
        // Show progress pabr
        var tpl = '<div data-unique-identifier="'+file.uniqueIdentifier+'">'+file.fileName+'</div>';
        $('#J_selectFile').before(tpl);
        r.upload();
    });
    r.on('fileSuccess', function(file,message){
        // Reflect that the file upload has completed
        console.log('success',file,message);
    });
    r.on('fileError', function(file, message){
        console.log('error',file,message);

    });
</script>


<script>
    var $projectForm = $('#projectForm');


    $projectForm.on('submit', function(e) {
        e.preventDefault();
        var data = new FormData(this);
        $.ajax({
            method: "POST",
            url: "/addProject",
            contentType: false,
            processData: false,
            data: data
        }).done(function(msg) {
            window.location.href = '/admin';
        }).fail(function(msg) {
                alert(msg);
        });
    });
</script>
</body>
</html>